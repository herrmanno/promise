!function(){window.Promise=function e(t,n){var o=this;this.data=void 0,this.resolved=!1,this.rejected=!1,this.done=!1,"function"==typeof t&&(this.onResolve=t),"function"==typeof n&&(this.onReject=n),"string"==typeof t&&(this.name=t),this.ret=void 0,this.set=function(e){if(o.done)throw"Promise is already resolved / rejected";o.data=e},this.resolve=function(e){o.set(e),o.resolved=o.done=!0,o.onResolve&&o._resolve()},this._resolve=function(){o.ret||(o.ret=new e("Return-Promise"+o.name));var t=o.onResolve(o.data);t&&t instanceof e?t.then(o.ret.resolve,o.ret.reject):o.ret.resolve(t)},this.reject=function(e){o.set(e),o.rejected=o.done=!0,o.onReject&&o.onReject(this.data),o.ret&&o.ret.reject(this.data)},this._reject=function(){o.ret||(o.ret=new e("Return-Promise"+o.name)),o.onReject(o.data),o.ret.reject(o.data)},this.then=function(t,n){return o.ret=new e("Return-Promise"+o.name),t&&"function"==typeof t&&(o.onResolve=t),n&&"function"==typeof n&&(o.onReject=n),o.resolved&&o._resolve(),o.rejected&&o._reject(),o.ret},this["catch"]=function(e){o.onReject=e,o.rejected&&o._reject()}},window.Promise.all=function(e){var t=new Promise,n=[];return 0===e.length?t.resolve():e.forEach(function(o,r){o.then(function(o){if(!t.done){n[r]=o;var i=e.reduce(function(e,t){return e&&t.resolved},!0);i&&t.resolve(n)}})["catch"](function(e){t.reject(e)})}),t},window.Promise.create=function(e){if(e instanceof Promise)return e;var t=new Promise;return void 0===e||null===e||e===!1?t.reject(e):t.resolve(e),t}}();